import React, { Component } from 'react'
import { connect } from 'react-redux'
import { Link } from 'react-router-dom'

import s from './Phones.module.css'
import {fetchPhones,loadMorePhones, addPhoneToBasket,fetchCategories } from 'containers/actions'
import {getPhones} from 'reducers/selectors'
import Layout from 'containers/Layout/index'


class Phones extends Component {
   
    componentDidMount(){
        this.props.fetchPhones()
        this.props.fetchCategories()
      
    }
    renderPhone(phone, index) {
        // const shortDescription = `${R.take(60, phone.description)}`
        const {addPhoneToBasket} = this.props
        return(
            <div className={s.card} key={index}>
                <div className={s.imgs}>
                    <img 
                    src={phone.image}
                    alt={phone.name } style={{width:'150px'}} />
                </div>
                <div className={s.info}>
        <div className={s.price}>${phone.price}
        <h4 className={s.link}>
            <Link className={s.linkphone} to={`/phones/${phone.id}`}>
                {phone.name}
            </Link>
        </h4>
        </div>
       
        <p className={s.description}>The description... </p>
        <p className={s.but}>
            <button className={s.button}
            onClick={()=>addPhoneToBasket(phone.id)}>
                By Now
            </button>
            <Link to={`/phones/${phone.id}`} className={s.moreInfo}>
                More Info
            </Link>
        </p>
                </div>

            </div>
        )
    }

    render(){
       const {phones, loadMorePhones}=this.props
        return (
            <Layout>
            <div className={s.wrapp}>
                {phones.map((phone,index)=>this.renderPhone(phone,index))}
            <div className={s.morePhone}>
                <button className={s.btn} onClick={loadMorePhones}>More </button>
            </div>
            </div>
            </Layout>
            
        )
    }

}
const mapStateToProps = (state,ownProps)=> ({
    phones: getPhones(state,ownProps)
})
const mapDispatchToProps = {
    loadMorePhones ,
    fetchPhones,
    addPhoneToBasket,
    fetchCategories
}
export default connect(mapStateToProps,mapDispatchToProps)(Phones)